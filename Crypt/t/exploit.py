from Crypto.Util.number import getPrime, bytes_to_long
from math import gcd
from functools import reduce

# simulasi server
n = getPrime(1024)
a = getPrime(1024)

def server_response(x):
    return pow(a, x, n)

# kumpulin hasil
xs = [10**9+i for i in range(6)]
results = [server_response(x) for x in xs]

# recovery pakai relasi r_{i+1}^2 - r_i*r_{i+2}
candidates = []
for i in range(len(results)-2):
    r1, r2, r3 = results[i], results[i+1], results[i+2]
    diff = r2*r2 - r1*r3
    candidates.append(abs(diff))

n_guess = reduce(gcd, candidates)

print("n asli =", n)
print("n tebak=", n_guess)
print("Benar?", n == n_guess)
