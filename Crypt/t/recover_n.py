from math import gcd
from functools import reduce

# contoh: results = [r0, r1, r2, r3, r4, r5]
# results didapat dari server: integer hasil pow(a, x, n)
results = [...]  # isi dengan integer yang kamu kumpulkan

# buat daftar kandidat d_i = r_{i+1}^2 - r_i * r_{i+2}
candidates = [79047435964598880878782458103195427086265496568852460104528083641116126663205597880448486262583656062783883140233171278413342486137177337989452304837705057726955092431124759319049891258194433861983159087306965139101863164746296739176810389978760569435718908313552505202517797155816923696177988511808590534174,
              136224447028442213220236614483336134432557253236653969837642743112670983299331755947131340051886105069773855633672390079365335354487848169347555415066547064910572065030142423049968396669086422185807361192897093052801309813888077697619498669616882171081514476074984807786497196358780963667423674718090192506005,
              15172642736331385851171430424753857165054455798289953892037897047428508216164920282547033313164459913956151860365904710238857749807994869803957953497342249091201427602395479075219105035522591367487627467699876524245856746110574629722227719964386291982640460628324365477371970248346216782769184152364675737959,
              69027759835498675102691639004385682104558959416798848462324362970833257005622304580893017005899480329256012800044830026122015411915528241583779889472493534992379034624829598266773566119340804315174282252182509932314897207174894503524798960858710921003049817704479410813435247126259821297465106801911789337747,
              131205523385036974624071111079442636834991398881092233047699389430539723537971372641112590659346884259844925019726441258107018932539071571038660053571368556217893103187091130215534332848245712100623017290230064490988854047626149052796942977024661249086723682698972678488329958066871813470018544383231610860094]
for i in range(len(results) - 2):
    r1 = results[i]
    r2 = results[i+1]
    r3 = results[i+2]
    diff = r2*r2 - r1*r3
    candidates.append(abs(diff))

# ambil gcd dari semua kandidat
n_guess = reduce(gcd, candidates)
print("gcd_all =", n_guess)
print("bit_length:", n_guess.bit_length())

# beberapa pemeriksaan
if n_guess == 1:
    print("GCD = 1 â†’ gagal, coba ambil x yang lain atau lebih banyak samples.")
else:
    # seringkali n_guess sudah persis n
    print("Kemungkinan besar n =", n_guess)
    # jika n_guess bukan prima, mungkin n divides n_guess. Coba cek faktor primanya:
    try:
        import sympy
        facs = sympy.factorint(n_guess)
        print("Faktor prima dari gcd:", facs)
        # cari faktor dengan bit_length ~ 1024
        for p, e in facs.items():
            if p.bit_length() > 900:  # threshold, adjust jika perlu
                print("Mungkin n =", p)
    except Exception as e:
        print("sympy tidak tersedia / gagal faktorisasi otomatis.")
        print("Jika gcd terlalu besar dan bukan prima, gunakan alat faktorisasi (yafu/msieve) untuk memperoleh faktor 1024-bit.")
